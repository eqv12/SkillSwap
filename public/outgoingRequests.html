<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SkillSwap - Outgoing Requests</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="navbar">
    <header>
      <span class="logo">SkillSwap</span>
      <nav class="navList">
        <a href="#requests" class="register-link">Requests</a>
        <a href="#tutoring" class="register-link">Tutoring</a>
        <a href="#post" class="register-link">Post</a>
        <a href="#dashboard" class="register-link">Dashboard</a>
      </nav>
      <div class="right">
        <img src="./resources/user.svg" alt="Profile Icon" />
      </div>
    </header>
  </div>

  <!-- Section for displaying requests -->
  <div class="requests-container">
    <div id="requests-list">
      <!-- Requests will be injected here -->
    </div>
  </div>

  <div id="reqs-list" class="request-container">
    <h2>Outgoing Requests</h2>
    <!-- <div id="req" class="individual-request-container">
        <label id="topicLabel">Topic: </label><br>
        <label id="descrLabel">Description: </label><br>
        <label id="statusLabel">Status: </label>
    </div> -->
  </div>

  <script>
    // Fetch the list of outgoing requests from the server
    async function fetchOutgoingRequests() {
      try {
        const response = await fetch("http://localhost:3000/api/outgoingRequests");
        const requestsData = await response.json();
        console.log(requestsData);

        // Get the container where requests will be displayed
        const requestsList = document.getElementById("reqs-list");

        // Check if there are requests
        if (requestsData.length === 0) {
          requestsList.innerHTML = "<p>No outgoing requests available.</p>";
        } else {
          // Loop through each request and create HTML elements
          requestsData.forEach(request => {
            // document.getElementById("topicLabel").innerHTML += request.subjName
            const reqDiv = document.createElement("div");
            reqDiv.classList.add("individual-request-container");

            reqDiv.innerHTML = `<label><strong>Topic:</strong> ${request.subjName}</label><br>
            <label><strong>Description:</strong> ${request.descr}</label><br>
            <label><strong>Status:</strong> ${request.status}</label><br>
             <label><strong>Accepted By:</strong>  &lt;to be filled&gt;</label> `;
            

            // Append to the list
            requestsList.appendChild(reqDiv);
          });
        }
      } catch (error) {
        console.error("Error fetching requests:", error);
        const requestsList = document.getElementById("requests-list");
        requestsList.innerHTML = "<p>Failed to load requests. Please try again later.</p>";
      }
    }

    // Run the function when the page loads
    window.onload = fetchOutgoingRequests;
  </script>
</body>
</html>
